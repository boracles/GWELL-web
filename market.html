<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>장내자산관리공단 — Market</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://use.typekit.net/epz5qwi.css" />
    <link rel="stylesheet" href="assets/css/style.css" />

    <!-- Chart.js + 금융 차트 플러그인 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-chart-financial"></script>

    <!-- Supabase (필요하면 유지) -->
    <script src="https://unpkg.com/@supabase/supabase-js@2.48.0/dist/umd/supabase.js"></script>
    <script src="assets/js/supabase-init.js"></script>

    <!-- 우리 로직 -->
    <script src="assets/js/market.js" defer></script>
  </head>
  <body class="market-body">
    <div class="market-safe">
      <div class="market-shell">
        <header class="market-header">
          <div class="market-logo">
            <img
              src="assets/img/Logo.png"
              alt="장내자산관리공단"
              class="market-logo-img"
            />
          </div>
          <div class="market-header-right" id="marketTime"></div>
        </header>

        <!-- 이슈/뉴스 바 (더 크게) -->
        <div class="issue-bar issue-bar--market">
          <span class="issue-tag" id="issueTag">ISSUE</span>
          <div class="issue-text-wrap">
            <span class="issue-text" id="issueText">
              초기 이슈 로딩 중...
            </span>
          </div>
        </div>

        <main class="market-main">
          <!-- 상단 티커 + 우측 수치/파라미터 -->
          <section class="market-top-row">
            <!-- 좌: 방금 스캔된 ID + 현재가 -->
            <div class="market-top-left">
              <div class="mt-id-line">
                <span class="mt-id-label">ID</span>
                <span class="mt-id" id="tickerId">GA-01</span>
              </div>

              <div class="mt-price-main">
                <span class="mt-price" id="tickerPrice">0.00</span>
                <span class="mt-delta" id="tickerDelta">+0.00</span>
              </div>

              <div class="mt-rate-line">
                <span class="mt-rate" id="tickerRate">+0.00%</span>
                <span class="mt-sub" id="tickerSub">
                  장내 자산 실시간 상장 상태
                </span>
              </div>
              <!-- 🔹 여기서 mt-meta 블록 완전히 제거 -->
            </div>

            <!-- 우: 기본 시세 + 장내 파라미터 -->
            <!-- 우: 기본 시세 + 장내 파라미터 + 장내 원천 지표 -->
            <div class="market-top-right">
              <!-- 왼쪽 컬럼: 시세 정보 -->
              <div class="mt-stat-col">
                <div class="mt-stat-row">
                  <span class="label">Open</span>
                  <span class="value" id="statOpen">-</span>
                </div>
                <div class="mt-stat-row">
                  <span class="label">High</span>
                  <span class="value" id="statHigh">-</span>
                </div>
                <div class="mt-stat-row">
                  <span class="label">Low</span>
                  <span class="value" id="statLow">-</span>
                </div>
                <div class="mt-stat-row">
                  <span class="label">52 w high</span>
                  <span class="value" id="stat52High">-</span>
                </div>
                <div class="mt-stat-row">
                  <span class="label">52 w low</span>
                  <span class="value" id="stat52Low">-</span>
                </div>
              </div>

              <!-- 가운데 컬럼: 사회 파라미터 -->
              <div class="mt-stat-col">
                <div class="mt-stat-row">
                  <span class="label">정제율</span>
                  <span class="value" id="metricPurity">0%</span>
                </div>
                <div class="mt-stat-row">
                  <span class="label">사회 효율 환산가</span>
                  <span class="value" id="metricEfficiency">0.00</span>
                </div>
                <div class="mt-stat-row">
                  <span class="label">사회 기여도</span>
                  <span class="value" id="metricContribution">-</span>
                </div>
                <div class="mt-stat-row">
                  <span class="label">거래 등급</span>
                  <span class="value" id="metricLevel">Lv0</span>
                </div>
              </div>

              <!-- 오른쪽 컬럼: 장내 원천 지표 D/B/P -->
              <div class="mt-stat-col mt-gut-col">
                <div class="mt-stat-row">
                  <span class="label">다양성 (D)</span>
                  <span class="value" id="metricDiversity">-</span>
                </div>
                <div class="mt-stat-row">
                  <span class="label">유익도 (B)</span>
                  <span class="value" id="metricBenefit">-</span>
                </div>
                <div class="mt-stat-row">
                  <span class="label">위험도 (P)</span>
                  <span class="value" id="metricRisk">-</span>
                </div>
              </div>
            </div>
          </section>

          <section class="chart-panel">
            <div class="chart-panel">
              <!-- 🔹 캔들 + 볼륨: 같은 구역 -->
              <div class="chart-main">
                <div class="chart-main-top">
                  <canvas id="priceChart"></canvas>
                  <!-- 캔들 -->
                </div>
                <div class="chart-main-bottom">
                  <canvas id="volumeChart"></canvas>
                  <!-- 막대 -->
                </div>
              </div>

              <!-- 🔹 아래 별도: 정상성 지수 인디케이터 -->
              <section class="chart-indicator">
                <div class="indicator-label">정상성 지수</div>
                <canvas id="indicatorChart"></canvas>
              </section>
            </div>
          </section>

          <!-- ID별 가치 비교 테이블 -->
          <section class="comparison-panel">
            <div class="comparison-title">장내 자산 상대 가치 분포</div>
            <table class="comparison-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>프로필</th>
                  <th>Value</th>
                  <th>Δ</th>
                  <th>Theme</th>
                  <th>사회 기여도</th>
                  <th>거래 등급</th>
                </tr>
              </thead>
              <tbody id="comparisonBody"></tbody>
            </table>
          </section>

          <footer class="market-footer">
            공단 자산 거래소에 상장된 자산 현황입니다. 수치는 시장 상황에 따라
            자동 반영됩니다.
          </footer>
        </main>
      </div>
    </div>
  </body>
</html>
